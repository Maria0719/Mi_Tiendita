{% extends 'base.html' %}
<!-- Hereda la estructura base, incluyendo la barra lateral y estilos globales -->

{% block content %}
<!-- Inicia el bloque de contenido que se insertará en la plantilla base -->

<div class="container mt-4">
    <!-- Contenedor principal con margen superior -->

    <h1 class="text-center mb-4">📊 Gráficas Financieras</h1>
    <!-- Título centrado con ícono de gráfico -->

    <!-- ==== GRÁFICA 1 ==== -->
    <div class="card mb-5 shadow-sm">
        <!-- Tarjeta con sombra y margen inferior -->

        <div class="card-body">
            <!-- Contenido interno de la tarjeta -->

            <h4 class="card-title text-center">Porcentaje de Ganancia por Producto</h4>
            <!-- Subtítulo centrado -->

            <div style="overflow-x:auto">
                <!-- Permite hacer scroll horizontal si la imagen es muy ancha -->

                {% if grafica1 %}
                <!-- Si existe la imagen base64 en la variable grafica1 -->

                <img src="data:image/png;base64,{{ grafica1 }}" class="img-fluid mt-3" 
                    alt="Gráfica de ganancia por porcentaje" style="max-height: 500px;">
                <!-- Muestra la imagen generada desde Flask codificada en base64 -->
                <p class="text-muted text-center mt-2">
                    📊 <strong>¿Qué muestra?</strong><br>
                        Esta gráfica representa el <strong>porcentaje de ganancia individual</strong> aplicado a cada producto. Es decir, cuánto más estás cobrando sobre el precio de compra.
                </p>
                <p class="text-muted text-center">
                ✅ <strong>¿Cómo se calcula?</strong> 
                ((Precio de Venta - Precio de Compra) ÷ Precio de Compra) × 100<br>
                ✅ <strong>¿Para qué sirve?</strong> 
                Te ayuda a comparar el margen de utilidad entre productos y detectar inconsistencias.
                </p>
 
                {% else %}
                <p class="text-center text-muted mt-3">⚠ No hay datos disponibles para esta gráfica.</p>
                <!-- Mensaje en caso de que no se haya generado la gráfica -->
                {% endif %}
            </div>

            <p class="text-muted text-center mt-2">
                Representa el porcentaje de ganancia aplicado a cada producto.
            </p>
        </div>
    </div>

    <!-- ==== GRÁFICA 2 ==== -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <h4 class="card-title text-center">Resumen Financiero</h4>
            {% if grafica2 %}
            <img src="data:image/png;base64,{{ grafica2 }}" class="img-fluid mt-3" alt="Gráfica de resumen financiero">
            <p class="text-muted text-center mt-2">
    📊 <strong>¿Qué muestra?</strong><br>
    Compara visualmente la <strong>ganancia bruta, los gastos registrados y la ganancia neta final</strong>.
</p>
<p class="text-muted text-center">
    ✅ <strong>Ganancia bruta:</strong> ingresos esperados si vendes todo el inventario.<br>
    ✅ <strong>Gastos:</strong> suma total de egresos operativos.<br>
    ✅ <strong>Ganancia neta:</strong> utilidad final después de restar los gastos.<br>
    Ideal para tener una visión rápida del estado económico general.
</p>
            {% else %}
            <p class="text-center text-muted mt-3">⚠ No hay datos disponibles para esta gráfica.</p>
            {% endif %}
            <p class="text-muted text-center mt-2">
                Ganancia bruta = Ingresos - Costos | Ganancia neta = Ganancia bruta - Gastos
            </p>
        </div>
    </div>

    <!-- ==== GRÁFICA 3 ==== -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <h4 class="card-title text-center">Top 5 Productos por Valor de Inventario</h4>
            {% if grafica3 %}
            <img src="data:image/png;base64,{{ grafica3 }}" class="img-fluid mt-3" alt="Top Inventario">
            <p class="text-muted text-center mt-2">
    📊 <strong>¿Qué muestra?</strong><br>
    Muestra los 5 productos en los que tienes mayor <strong>dinero invertido en stock</strong>, calculado por el precio de compra multiplicado por la cantidad.
</p>
<p class="text-muted text-center">
    ✅ <strong>¿Cómo se calcula?</strong> Precio de Compra × Stock<br>
    ✅ <strong>¿Para qué sirve?</strong> 
    Identifica en qué productos estás comprometiendo más capital y si eso se alinea con tus ventas.
</p>

            {% else %}
            <p class="text-center text-muted mt-3">⚠ No hay datos disponibles para esta gráfica.</p>
            {% endif %}
        </div>
    </div>

    <!-- ==== GRÁFICA 4 ==== -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body">
            <h4 class="card-title text-center">Ganancia Promedio por Categoría</h4>
            {% if grafica4 %}
            <img src="data:image/png;base64,{{ grafica4 }}" class="img-fluid mt-3" alt="Ganancia por Categoría">
            <p class="text-muted text-center mt-2">
    📊 <strong>¿Qué muestra?</strong><br>
    Esta gráfica calcula el <strong>porcentaje promedio de ganancia</strong> agrupado por categoría de producto.
</p>
<p class="text-muted text-center">
    ✅ <strong>¿Cómo se calcula?</strong> Promedio de ((Venta - Compra) ÷ Compra × 100) por categoría<br>
    ✅ <strong>¿Para qué sirve?</strong> 
    Identifica qué tipo de productos son más rentables y enfoca tu estrategia en ellos.
</p>

            {% else %}
            <p class="text-center text-muted mt-3">⚠ No hay datos disponibles para esta gráfica.</p>
            {% endif %}
        </div>
    </div>

    <!-- BOTÓN DE VOLVER -->
    <div class="text-center mt-5">
        <a href="{{ url_for('index') }}" class="btn btn-primary">⬅ Volver al inicio</a>
    </div>
</div>

{% endblock %}
<!-- Cierra el bloque de contenido -->
